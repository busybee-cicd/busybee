{"version":3,"file":"restream.js","sourceRoot":"","sources":["../../../src/lib/restream.ts"],"names":[],"mappings":";AAAA,iBAAS,UAAA,OAAO;IACd,OAAO,GAAG,OAAO,IAAI,EAAE,CAAC;IACxB,OAAO,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,IAAI,MAAM,CAAC;IAC9C,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC;IAExD,OAAO,UAAS,GAAG,EAAE,GAAG,EAAE,IAAI;QAC5B,GAAG,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC;QAC/B,GAAG,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;QAC9B,IAAI,GAAG,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,SAAS,EAAE;YAC/C,GAAG,CAAC,OAAO,CAAC,gBAAgB,CAAC,GAAG,MAAM,CAAC,UAAU,CAC/C,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,EACxC,MAAM,CACP,CAAC;SACH;QACD,OAAO,CAAC,QAAQ,CAAC;YACf,IAAI,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;gBACzB,IAAI,UAAU,KAAK,OAAO,OAAO,CAAC,MAAM;oBACtC,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAChE,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;aAC5D;YACD,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAClB,CAAC,CAAC,CAAC;QACH,IAAI,EAAE,CAAC;IACT,CAAC,CAAC;AACJ,CAAC,CAAC","sourcesContent":["export = options => {\r\n  options = options || {};\r\n  options.property = options.property || 'body';\r\n  options.stringify = options.stringify || JSON.stringify;\r\n\r\n  return function(req, res, next) {\r\n    req.removeAllListeners('data');\r\n    req.removeAllListeners('end');\r\n    if (req.headers['content-length'] !== undefined) {\r\n      req.headers['content-length'] = Buffer.byteLength(\r\n        options.stringify(req[options.property]),\r\n        'utf8'\r\n      );\r\n    }\r\n    process.nextTick(function() {\r\n      if (req[options.property]) {\r\n        if ('function' === typeof options.modify)\r\n          req[options.property] = options.modify(req[options.property]);\r\n        req.emit('data', options.stringify(req[options.property]));\r\n      }\r\n      req.emit('end');\r\n    });\r\n    next();\r\n  };\r\n};\r\n"]}